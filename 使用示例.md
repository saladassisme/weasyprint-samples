# 回忆录成书使用示例

## 快速开始

### 1. 准备数据
编辑 `biography_data.json` 文件：

```json
{
  "book_info": {
    "title": "我的回忆录",
    "author": "您的姓名",
    "compiler": "小鹿光年整理制作",
    "copyright": "本书仅供展示，未经许可不得复制或使用"
  },
  "chapters": [
    {
      "id": 1,
      "title": "童年时光",
      "qr_link": "https://example.com/childhood",
      "content": [
        "这是我童年的第一段回忆...",
        "那时候的生活虽然艰苦，但是很快乐..."
      ]
    },
    {
      "id": 2,
      "title": "求学之路",
      "qr_link": "https://example.com/education",
      "content": [
        "上学的时候，我最喜欢的是...",
        "老师对我的影响很大..."
      ]
    }
  ]
}
```

### 2. 生成PDF
运行命令：
```bash
python generate_book_style.py
```

### 3. 查看结果
- PDF文件：`output/顾火良回忆录_Book风格_v3_CSS交叉引用版.pdf`
- 二维码：`qr_codes/chapter_1_qr.png`, `qr_codes/chapter_2_qr.png`

## 功能演示

### 水印效果
- 文本：从 `book_info.compiler` 字段读取
- 样式：45°倾斜，透明灰色，60pt字体
- 位置：页面中央，z-index=1000

### 二维码生成
- 自动检测 `qr_link` 字段
- 生成PNG格式二维码图片
- 失败时自动使用默认二维码

### 分页系统
- 章节自动分页到右页
- 配图页面在左页
- 动态计算准确页码

## 自定义选项

### 修改水印文案
```json
{
  "book_info": {
    "compiler": "您的自定义水印"
  }
}
```

### 添加章节链接
```json
{
  "id": 3,
  "title": "工作经历",
  "qr_link": "https://your-website.com/work",
  "content": ["工作内容..."]
}
```

### 添加图片
```json
{
  "images": [
    {
      "url": "path/to/image.jpg",
      "alt": "图片描述",
      "caption": "图片说明文字"
    }
  ]
}
```

## 输出文件说明

### 主要输出
- **PDF文件**: 最终的书籍PDF
- **调试HTML**: 用于检查渲染效果的HTML文件

### 辅助文件
- **二维码目录**: `qr_codes/` 包含所有生成的二维码
- **字体文件**: `fonts/` 自定义字体文件
- **图片资源**: 章节配图和其他图片

## 故障排除

### 常见问题
1. **二维码不显示**: 检查 `qr_link` 字段格式
2. **字体显示异常**: 确认字体文件存在
3. **PDF生成失败**: 查看调试HTML文件
4. **页码错误**: 使用预渲染版本脚本

### 调试步骤
1. 检查JSON格式是否正确
2. 查看生成的调试HTML文件
3. 确认所有资源文件存在
4. 检查控制台错误信息

## 高级用法

### 批量处理
```python
import json
from pathlib import Path

# 处理多个JSON文件
for json_file in Path(".").glob("*.json"):
    # 生成对应的PDF
    generate_book_from_json(json_file)
```

### 自定义样式
编辑 `templates/biography_book_style_v3.html` 中的CSS部分：

```css
/* 修改水印样式 */
.watermark {
    font-size: 48pt;  /* 调整字体大小 */
    color: rgba(0, 0, 0, 0.1);  /* 调整透明度 */
    transform: translate(-50%, -50%) rotate(-30deg);  /* 调整角度 */
}

/* 修改章节样式 */
.chapter-content-page {
    padding: 1cm;  /* 调整内边距 */
}
```

---

*更多详细信息请参考《回忆录成书实现说明文档.md》*
